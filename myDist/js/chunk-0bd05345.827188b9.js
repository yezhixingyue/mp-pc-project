(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0bd05345"],{4794:function(e,t,r){"use strict";r.r(t);var n=(r("a15b"),r("d81d"),r("ac1f"),r("5319"),r("1276"),r("96cf"),r("1da1")),o=r("5530"),i=r("2f62"),a={data:function(){var e=this,t=function(t,r,n){e.validateCheck(r,e.defineRules.VertifyCodeRules,n)&&n()};return{codeRules:{VertifyCode:[{validator:t,trigger:"blur"}]},newMobileRules:{newMobile:[{validator:function(t,r,n){e.validateCheck(r,e.defineRules.Mobile,n)&&n()},trigger:"blur"}],VertifyCode:[{validator:t,trigger:"blur"}]},active:0,codeForm:{Mobile:"",VertifyCode:""},newMobileForm:{newMobile:"",VertifyCode:""},codeTitle:"获取短信验证码",codeTitle2:"获取短信验证码",timer:null,canGetCode:!0,canGetCode2:!0,firstRes:null,defineRules:{Mobile:[{strategy:"isNotEmpty",errorMsg:"请输入手机号!"},{strategy:"shouldLength:11",errorMsg:"请输入11位手机号码"},{strategy:"isPhone",errorMsg:"手机号码格式不正确"}],VertifyCodeRules:[{strategy:"isNotEmpty",errorMsg:"请输入短信验证码"},{strategy:"shouldLength:6",errorMsg:"短信验证码长度为6位"}]}}},computed:Object(o.a)(Object(o.a)({},Object(i.e)("common",["customerInfo"])),{},{Mobile:{get:function(){return this.codeForm.Mobile},set:function(e){this.codeForm.Mobile=e.replace(/[^\d.]/g,"")}},VertifyCode:{get:function(){return this.codeForm.VertifyCode},set:function(e){this.codeForm.VertifyCode=e.replace(/[^\d]/g,"")}},VertifyCode2:{get:function(){return this.newMobileForm.VertifyCode},set:function(e){this.newMobileForm.VertifyCode=e.replace(/[^\d]/g,"")}}}),watch:{customerInfo:function(e){}},methods:{next:function(){var e=this;0===this.active&&this.$refs.codeForm.validate(function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(r){var n,o,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=7;break}return n=e.codeForm.VertifyCode,o={VertifyCode:n},t.next=5,e.api.getCheckCode(o);case 5:1e3===(i=t.sent).data.Status&&(e.firstRes=i.data.Data,e.active+=1);case 7:return t.abrupt("return",!1);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),1===this.active&&this.$refs.newMobileForm.validate(function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(r){var n,o,i,a,s,c,l,u,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=9;break}return n=e.newMobileForm,o=n.newMobile,i=n.VertifyCode,a=o,s=e.firstRes,c=s.Sign,l=s.TimeStamp,u=s.UserID,d={Sign:c,TimeStamp:l,UserID:u,Mobile:a,VertifyCode:i},t.next=7,e.api.getCustomerChangeMobile(d);case 7:1e3===t.sent.data.Status&&(e.active+=1,e.$store.commit("common/changeCustomerPhone",o));case 9:return t.abrupt("return",!1);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getVertifyCode:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canGetCode){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.api.getSmsCode(null,2);case 4:1e3===t.sent.data.Status&&e.changeCodeTitleAtSecond();case 6:case"end":return t.stop()}}),t)})))()},changeCodeTitleAtSecond:function(){var e=this,t=60;this.canGetCode=!1,this.codeTitle="".concat(t,"秒后重新获取"),this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){t-=1,e.codeTitle="".concat(t,"秒后重新获取"),0===t&&(e.codeTitle="重新获取验证码",clearInterval(e.timer),e.canGetCode=!0)}),1e3)},getVertifyCode2:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.canGetCode2){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,e.api.getSmsCode(e.newMobileForm.newMobile,3);case 4:1e3===t.sent.data.Status&&e.changeCodeTitleAtSecond2();case 6:case"end":return t.stop()}}),t)})))()},changeCodeTitleAtSecond2:function(){var e=this,t=60;this.canGetCode2=!1,this.codeTitle2="".concat(t,"秒后重新获取"),this.timer&&clearInterval(this.timer),this.timer=setInterval((function(){t-=1,e.codeTitle2="".concat(t,"秒后重新获取"),0===t&&(e.codeTitle2="重新获取验证码",clearInterval(e.timer),e.canGetCode2=!0)}),1e3)},formatMobile:function(e){return e&&11===e.length?e.split("").map((function(e,t){return t>2&&t<7?"*":e})).join(""):""}}},s=(r("7741"),r("2877")),c={components:{ChangePhoneComp:Object(s.a)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"mp-pc-my-setting-page-change-phone-comp-wrap"},[r("el-steps",{attrs:{active:e.active}},[r("el-step",{attrs:{title:"验证身份"}}),r("el-step",{attrs:{title:"修改手机号"}}),r("el-step",{attrs:{title:"完成"}})],1),r("div",{staticClass:"content"},[0===e.active&&e.customerInfo?r("el-form",{key:"find-pwd-form-0001",ref:"codeForm",attrs:{model:e.codeForm,"status-icon":"",rules:e.codeRules,"label-width":"100px"}},[r("div",{staticClass:"before-phone-wrap"},[r("span",{staticClass:"title"},[e._v("手机号码： ")]),r("span",[e._v(e._s(e.formatMobile(e.customerInfo.Account.Mobile)))])]),r("el-form-item",{staticClass:"code-box",attrs:{prop:"VertifyCode",label:"短信验证码："}},[r("el-input",{attrs:{placeholder:"请输入短信验证码"},model:{value:e.VertifyCode,callback:function(t){e.VertifyCode="string"==typeof t?t.trim():t},expression:"VertifyCode"}}),r("span",{staticClass:"span-title-blue",class:e.canGetCode?"":"disabled",on:{click:e.getVertifyCode}},[e._v(e._s(e.codeTitle))])],1)],1):e._e(),1===e.active?r("el-form",{key:"find-pwd-form-0002",ref:"newMobileForm",attrs:{model:e.newMobileForm,"status-icon":"",rules:e.newMobileRules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"新手机号：",prop:"newMobile"}},[r("el-input",{attrs:{placeholder:"请输入新手机号"},model:{value:e.newMobileForm.newMobile,callback:function(t){e.$set(e.newMobileForm,"newMobile","string"==typeof t?t.trim():t)},expression:"newMobileForm.newMobile"}})],1),r("el-form-item",{staticClass:"code-box",attrs:{prop:"VertifyCode",label:"短信验证码："}},[r("el-input",{attrs:{placeholder:"请输入短信验证码"},model:{value:e.VertifyCode2,callback:function(t){e.VertifyCode2="string"==typeof t?t.trim():t},expression:"VertifyCode2"}}),r("span",{staticClass:"span-title-blue",class:e.canGetCode2?"":"disabled",on:{click:e.getVertifyCode2}},[e._v(e._s(e.codeTitle2))])],1)],1):e._e(),2===e.active?r("div",{staticClass:"res-wrap"},[r("i",{staticClass:"iconfont icon-wancheng"}),e._v("修改成功 ")]):e._e()],1),0===e.active||1===e.active?r("footer",[r("el-button",{attrs:{type:"primary"},on:{click:e.next}},[e._v("下一步")])],1):e._e()],1)}),[],!1,null,null,null).exports}},l=Object(s.a)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("span",{staticClass:"blue-v-line is-bold is-black"},[e._v("修改手机号")]),r("ChangePhoneComp")],1)}),[],!1,null,null,null);t.default=l.exports},7741:function(e,t,r){"use strict";var n=r("c6ae");r.n(n).a},c6ae:function(e,t,r){}}]);