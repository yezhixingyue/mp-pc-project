(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-dccafdc0"],{"9a12":function(t,e,n){"use strict";n.r(e);var s=(n("4de4"),n("7db0"),n("a434"),n("ac1f"),n("5319"),n("96cf"),n("1da1")),o=n("5530"),a=n("2f62"),u={components:{Count:n("8aa1").a},data:function(){return{couponCode2Add:"",unusedCouponList:[],usedCouponList:[],expiredCouponList:[],curSelectedOption:0,newCouponCode:"",countData:null,Page0:1,Page1:1,Page2:1}},computed:Object(o.a)(Object(o.a)({},Object(a.e)("common",["customerInfo"])),{},{computedCouponCode2Add:{get:function(){return this.couponCode2Add},set:function(t){this.couponCode2Add=t.replace(/[^\w]/g,"")}},curStatusText:function(){return 0===this.curSelectedOption?"未使用":1===this.curSelectedOption?"已使用":2===this.curSelectedOption?"已过期":""},CountObj:function(){if(!this.countData)return{unused:0,used:0,outOfDate:0};var t=this.countData.find((function(t){return 0===t.First})),e=this.countData.find((function(t){return 1===t.First})),n=this.countData.find((function(t){return 2===t.First}));return{unused:t.Second,used:e.Second,outOfDate:n.Second}},couponDataNumber:function(){var t=this;return this.countData?this.countData.find((function(e){return e.First===t.curSelectedOption})).Second:0},Page:function(){var t=1;switch(this.curSelectedOption){case 0:t=this.Page0;break;case 1:t=this.Page1;break;case 2:t=this.Page2}return t},curSelectedList:function(){var t=[];switch(this.curSelectedOption){case 0:t=this.unusedCouponList;break;case 1:t=this.usedCouponList;break;case 2:t=this.expiredCouponList}return t}}),methods:{getCouponActivate:function(){var t=this;return Object(s.a)(regeneratorRuntime.mark((function e(){var n,s,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.couponCode2Add){e.next=2;break}return e.abrupt("return");case 2:if(10===t.couponCode2Add.length){e.next=5;break}return t.messageBox.warnSingleError({title:"激活失败",msg:"请输入10位优惠券码"}),e.abrupt("return");case 5:return e.next=7,t.$store.dispatch("common/getCustomerDetail");case 7:if(t.customerInfo){e.next=9;break}return e.abrupt("return");case 9:return n=t.customerInfo.CustomerID,s=t.couponCode2Add,o={CustomerID:n,CouponCode:s},e.next=14,t.api.getCouponActivate(o);case 14:if(1e3===(a=e.sent).data.Status){e.next=17;break}return e.abrupt("return");case 17:t.couponCode2Add="",t.messageBox.successSingle({title:"激活成功",successFunc:function(){t.unusedCouponList.unshift(a.data.Data);var e=t.unusedCouponList;t.unusedCouponList=[],t.newCouponCode=a.data.Data.CouponCode,t.countData.find((function(t){return 0===t.First})).Second+=1,t.curSelectedOption=0,setTimeout((function(){e.length>9?t.unusedCouponList=e.splice(0,9):t.unusedCouponList=e}),30)}});case 19:case"end":return e.stop()}}),e)})))()},getCouponList:function(){var t=arguments,e=this;return Object(s.a)(regeneratorRuntime.mark((function n(){var s,o,a;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s=t.length>0&&void 0!==t[0]?t[0]:1,o={Page:s,PageSize:9,UseStatus:e.curSelectedOption},n.t0=e.curSelectedOption,n.next=0===n.t0?5:1===n.t0?7:2===n.t0?9:11;break;case 5:return e.Page0=s,n.abrupt("break",12);case 7:return e.Page1=s,n.abrupt("break",12);case 9:return e.Page2=s,n.abrupt("break",12);case 11:return n.abrupt("break",12);case 12:return 0===e.curSelectedOption&&(e.unusedCouponList=[]),1===e.curSelectedOption&&(e.usedCouponList=[]),2===e.curSelectedOption&&(e.expiredCouponList=[]),n.next=17,e.api.getMyCoupon(o);case 17:if(1e3===(a=n.sent).data.Status){n.next=20;break}return n.abrupt("return");case 20:e.newCouponCode="",0===e.curSelectedOption&&(e.unusedCouponList=a.data.Data.Second),1===e.curSelectedOption&&(e.usedCouponList=a.data.Data.Second),2===e.curSelectedOption&&(e.expiredCouponList=a.data.Data.Second),e.countData=a.data.Data.First;case 25:case"end":return n.stop()}}),n)})))()},handlePageChange:function(t){this.getCouponList(t)},handleSwitchStatus:function(t){this.curSelectedOption=t,this.newCouponCode="";var e=this.countData.find((function(e){return e.First===t}));this.curSelectedList.length!==e.Second&&(0===this.curSelectedList.length||this.curSelectedList.length<=9&&e.Second<=9)&&this.getCouponList()},handleDelClick:function(t){var e=this,n=t.CouponCode,s=t.Status,o="";switch(s){case 0:o="未使用";break;case 1:o="已使用";break;case 2:o="已过期"}this.messageBox.warnCancelBox({title:"确定删除该优惠券吗?",msg:"选中优惠券状态：[ ".concat(o," ]"),successFunc:function(){e.getCouponRemove(n,s)}})},getCouponRemove:function(t,e){var n=this;return Object(s.a)(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,n.api.getCouponRemove(t);case 2:if(1e3===s.sent.data.Status){s.next=5;break}return s.abrupt("return");case 5:n.messageBox.successSingle({title:"删除成功",successFunc:function(){0===e&&(n.unusedCouponList=n.unusedCouponList.filter((function(e){return e.CouponCode!==t}))),1===e&&(n.usedCouponList=n.usedCouponList.filter((function(e){return e.CouponCode!==t}))),2===e&&(n.expiredCouponList=n.expiredCouponList.filter((function(e){return e.CouponCode!==t}))),n.countData.find((function(t){return t.First===e})).Second-=1}});case 6:case"end":return s.stop()}}),s)})))()},jumpToCouponCenter:function(){this.$router.push("/mySetting/couponCenter")}},mounted:function(){this.countData||this.getCouponList()}},i=(n("a25e"),n("2877")),c=Object(i.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"mp-pc-my-setting-pages-my-coupons-page-wrap"},[n("header",[n("span",{staticClass:"blue-v-line is-bold is-black"},[t._v("我的优惠券")]),n("div",{staticClass:"add-box"},[n("span",[t._v("优惠券激活：")]),n("el-input",{attrs:{placeholder:"请输入优惠券激活码"},model:{value:t.computedCouponCode2Add,callback:function(e){t.computedCouponCode2Add="string"==typeof e?e.trim():e},expression:"computedCouponCode2Add"}}),n("el-button",{attrs:{type:"primary",disabled:!t.computedCouponCode2Add},on:{click:t.getCouponActivate}},[t._v("激活")])],1),n("div",{staticClass:"jump-btn"},[n("el-button",{on:{click:t.jumpToCouponCenter}},[n("i",{staticClass:"iconfont icon-lingquan"}),n("span",[t._v("领券中心")])])],1)]),n("section",{staticClass:"page-content"},[n("header",[n("span",{staticClass:"title"},[t._v("状态：")]),n("span",{staticClass:"status-item",class:{active:0===t.curSelectedOption},on:{click:function(e){return t.handleSwitchStatus(0)}}},[t._v("未使用（"+t._s(t.CountObj.unused)+"）")]),n("span",{staticClass:"status-item",class:{active:1===t.curSelectedOption},on:{click:function(e){return t.handleSwitchStatus(1)}}},[t._v("已使用（"+t._s(t.CountObj.used)+"）")]),n("span",{staticClass:"status-item",class:{active:2===t.curSelectedOption},on:{click:function(e){return t.handleSwitchStatus(2)}}},[t._v("已过期（"+t._s(t.CountObj.outOfDate)+"）")])]),t.curSelectedList.length>0?n("ul",{staticClass:"coupon-list"},t._l(t.curSelectedList,(function(e){return n("li",{key:e.CouponCode,staticClass:"coupon-item",class:{"add-new":e.CouponCode===t.newCouponCode,old:e.CouponCode!==t.newCouponCode&&t.newCouponCode,disabled:1===t.curSelectedOption||2===t.curSelectedOption}},[n("div",{staticClass:"top"},[n("p",{staticClass:"amount"},[n("i",[t._v("¥")]),n("span",[t._v(t._s(e.Amount))])]),n("p",{staticClass:"MinPayAmount"},[t._v("满"),n("i",{staticClass:"is-font-16"},[t._v(t._s(e.MinPayAmount))]),t._v("元可用")]),n("p",{staticClass:"ValidDate"},[n("span",[t._v(t._s(t._f("format2MiddleLangTypeDate")(e.ValidStartTime)))]),n("i",[t._v("-")]),n("span",[t._v(t._s(t._f("format2MiddleLangTypeDate")(e.ValidEndTime)))]),n("span",[t._v(" 可用")])]),n("div",{staticClass:"to-del",on:{click:function(n){return t.handleDelClick(e)}}},[n("i",{staticClass:"el-icon-close"})])]),n("div",{staticClass:"bottom"},[n("p",{staticClass:"coupon-code"},[n("span",{staticClass:"is-font-12 title"},[t._v("券编号：")]),n("span",{staticClass:"gray"},[t._v(t._s(e.CouponCode))])]),n("div",{staticClass:"product"},[n("span",{staticClass:"title is-font-12"},[t._v("限产品：")]),n("div",{staticClass:"text gray"},[n("el-tooltip",{attrs:{"popper-class":"table-item",enterable:!1,content:e.ProductString,placement:"top-start"}},[n("span",[t._v(t._s(e.ProductString))])])],1)])]),e.WillBeExpired?n("div",{staticClass:"will-out-time"},[n("span",{staticClass:"iconfont icon-fengtiao is-pink"}),n("span",{staticClass:"text"},[t._v("即将过期")])]):t._e(),1===t.curSelectedOption?n("div",{staticClass:"disabled-status"},[n("span",{staticClass:"iconfont icon-fengtiao"}),n("span",{staticClass:"text"},[t._v(t._s(t.curStatusText))])]):t._e(),2===t.curSelectedOption?n("div",{staticClass:"disabled-status"},[n("span",{staticClass:"iconfont icon-fengtiao"}),n("span",{staticClass:"text"},[t._v(t._s(t.curStatusText))])]):t._e()])})),0):n("div",{staticClass:"empty"},[t._v(" 暂无"+t._s(t.curStatusText)+"优惠券 ")]),n("footer",[n("Count",{attrs:{watchPage:t.Page,handlePageChange:t.handlePageChange,count:t.couponDataNumber,pageSize:9}})],1)])])}),[],!1,null,null,null);e.default=c.exports},a25e:function(t,e,n){"use strict";var s=n("dcbd");n.n(s).a},dcbd:function(t,e,n){}}]);